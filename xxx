REVISION: 4
RELEASED: Wed Mar 13 12:27:20 2019
CHART: preview-0.0.0-SNAPSHOT-PR-34-4
USER-SUPPLIED VALUES:
expose:
  Annotations:
    helm.sh/hook: post-install,post-upgrade
    helm.sh/hook-delete-policy: hook-succeeded
  config:
    domain: 35.196.59.141.nip.io
    exposer: Ingress
    http: "true"
preview:
  image:
    repository: 10.31.240.182:5000/vfarcic/go-demo-6
    tag: 0.0.0-SNAPSHOT-PR-34-4

COMPUTED VALUES:
cleanup:
  Annotations:
    helm.sh/hook: pre-delete
    helm.sh/hook-delete-policy: hook-succeeded
  Args:
  - --cleanup
  BackoffLimit: 5
  Image: jenkinsxio/exposecontroller
  ImageTag: 2.3.56
  global: {}
expose:
  Annotations:
    helm.sh/hook: post-install,post-upgrade
    helm.sh/hook-delete-policy: hook-succeeded
  BackoffLimit: 5
  Image: jenkinsxio/exposecontroller
  ImageTag: 2.3.56
  config:
    domain: 35.196.59.141.nip.io
    exposer: Ingress
    http: "true"
    tlsacme: false
  global: {}
preview:
  global: {}
  go-demo-6-db:
    affinity: {}
    clusterDomain: cluster.local
    global: {}
    image:
      debug: false
      pullPolicy: Always
      registry: docker.io
      repository: bitnami/mongodb
      tag: 4.0.3
    livenessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 30
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    metrics:
      enabled: false
      image:
        pullPolicy: IfNotPresent
        registry: docker.io
        repository: forekshub/percona-mongodb-exporter
        tag: latest
      podAnnotations:
        prometheus.io/port: "9216"
        prometheus.io/scrape: "true"
      serviceMonitor:
        additionalLabels: {}
        alerting:
          additionalLabels: {}
          rules: {}
        enabled: false
    mongodbDisableSystemLog: false
    mongodbEnableIPv6: true
    mongodbExtraFlags: []
    mongodbSystemLogVerbosity: 0
    nodeSelector: {}
    persistence:
      accessModes:
      - ReadWriteOnce
      annotations: {}
      enabled: true
      size: 8Gi
    podAnnotations: {}
    podLabels: {}
    readinessProbe:
      enabled: true
      failureThreshold: 6
      initialDelaySeconds: 5
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 5
    replicaSet:
      enabled: true
      name: rs0
      pdb:
        minAvailable:
          arbiter: 1
          primary: 1
          secondary: 1
      replicas:
        arbiter: 1
        secondary: 1
      useHostnames: true
    resources: {}
    securityContext:
      enabled: true
      fsGroup: 1001
      runAsUser: 1001
    service:
      annotations: {}
      port: 27017
      type: ClusterIP
    tolerations: []
    usePassword: true
  image:
    pullPolicy: IfNotPresent
    repository: 10.31.240.182:5000/vfarcic/go-demo-6
    tag: 0.0.0-SNAPSHOT-PR-34-4
  livenessProbe:
    initialDelaySeconds: 60
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 1
  probePath: /demo/hello?health=true
  readinessProbe:
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 1
  replicaCount: 1
  resources:
    limits:
      cpu: 100m
      memory: 256Mi
    requests:
      cpu: 80m
      memory: 128Mi
  service:
    annotations:
      fabric8.io/expose: "true"
      fabric8.io/ingress.annotations: 'kubernetes.io/ingress.class: nginx'
    externalPort: 80
    internalPort: 8080
    name: go-demo-6
    type: ClusterIP
  terminationGracePeriodSeconds: 10
preview-db:
  affinity: {}
  clusterDomain: cluster.local
  global: {}
  image:
    debug: false
    pullPolicy: Always
    registry: docker.io
    repository: bitnami/mongodb
    tag: 4.0.3
  livenessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 30
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  metrics:
    enabled: false
    image:
      pullPolicy: IfNotPresent
      registry: docker.io
      repository: forekshub/percona-mongodb-exporter
      tag: latest
    podAnnotations:
      prometheus.io/port: "9216"
      prometheus.io/scrape: "true"
    serviceMonitor:
      additionalLabels: {}
      alerting:
        additionalLabels: {}
        rules: {}
      enabled: false
  mongodbDisableSystemLog: false
  mongodbEnableIPv6: true
  mongodbExtraFlags: []
  mongodbSystemLogVerbosity: 0
  nodeSelector: {}
  persistence:
    accessModes:
    - ReadWriteOnce
    annotations: {}
    enabled: true
    size: 8Gi
  podAnnotations: {}
  podLabels: {}
  readinessProbe:
    enabled: true
    failureThreshold: 6
    initialDelaySeconds: 5
    periodSeconds: 10
    successThreshold: 1
    timeoutSeconds: 5
  replicaSet:
    enabled: false
    name: rs0
    pdb:
      minAvailable:
        arbiter: 1
        primary: 1
        secondary: 1
    replicas:
      arbiter: 1
      secondary: 1
    useHostnames: true
  resources: {}
  securityContext:
    enabled: true
    fsGroup: 1001
    runAsUser: 1001
  service:
    annotations: {}
    port: 27017
    type: ClusterIP
  tolerations: []
  usePassword: true

HOOKS:
---
# cleanup
apiVersion: batch/v1
kind: Job
metadata:
  name: cleanup
  labels:
    heritage: "Tiller"
    release: "jx-vfarcic-go-demo-6-pr-34"
    chart: "cleanup-2.3.56"
    component: "jx-vfarcic-go-demo-6-pr-34-cleanup"
  name: cleanup
  annotations:
    helm.sh/hook: pre-delete
    helm.sh/hook-delete-policy: hook-succeeded
    
spec:
  # backoffLimit: 5
  template:
    metadata:
      name: "jx-vfarcic-go-demo-6-pr-34"
      labels:
        heritage: "Tiller"
        release: "jx-vfarcic-go-demo-6-pr-34"
        chart: "cleanup-2.3.56"
    spec:
      containers:
      - env:
        - name: KUBERNETES_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        image: "jenkinsxio/exposecontroller:2.3.56"
        name: cleanup
        command: ["/exposecontroller"]
        args:
        - "--cleanup"
      serviceAccountName: cleanup
      restartPolicy: Never
---
# expose
apiVersion: batch/v1
kind: Job
metadata:
  name: expose
  labels:
    heritage: "Tiller"
    release: "jx-vfarcic-go-demo-6-pr-34"
    chart: "expose-2.3.56"
    component: "jx-vfarcic-go-demo-6-pr-34-expose"
  name: expose
  annotations:
    helm.sh/hook: post-install,post-upgrade
    helm.sh/hook-delete-policy: hook-succeeded
    
spec:
  # backoffLimit: 5
  template:
    metadata:
      name: "jx-vfarcic-go-demo-6-pr-34"
      labels:
        heritage: "Tiller"
        release: "jx-vfarcic-go-demo-6-pr-34"
        chart: "expose-2.3.56"
    spec:
      containers:
      - env:
        - name: KUBERNETES_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        image: "jenkinsxio/exposecontroller:2.3.56"
        name: expose
        command: ["/exposecontroller"]
        args:
      serviceAccountName: expose
      restartPolicy: Never
MANIFEST:

---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/poddisruptionbudget-arbiter-rs.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    heritage: Tiller
    release: jx-vfarcic-go-demo-6-pr-34
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-arbiter
spec:
  selector:
    matchLabels:
      app: go-demo-6-db
      release: jx-vfarcic-go-demo-6-pr-34
      component: arbiter
  minAvailable: 1
---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/poddisruptionbudget-primary-rs.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    heritage: Tiller
    release: jx-vfarcic-go-demo-6-pr-34
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-primary
spec:
  selector:
    matchLabels:
      app: go-demo-6-db
      release: jx-vfarcic-go-demo-6-pr-34
      component: primary
  minAvailable: 1
---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/poddisruptionbudget-secondary-rs.yaml
apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    heritage: Tiller
    release: jx-vfarcic-go-demo-6-pr-34
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-secondary
spec:
  selector:
    matchLabels:
      app: go-demo-6-db
      release: jx-vfarcic-go-demo-6-pr-34
      component: secondary
  minAvailable: 1
---
# Source: preview/charts/preview-db/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: jx-vfarcic-go-demo-6-pr-34-preview-db
  labels:
    app: preview-db
    chart: preview-db-5.3.0
    release: "jx-vfarcic-go-demo-6-pr-34"
    heritage: "Tiller"
type: Opaque
data:
  mongodb-root-password: "WHdEeFBETnp4VA=="
---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/secrets.yaml
apiVersion: v1
kind: Secret
metadata:
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    release: "jx-vfarcic-go-demo-6-pr-34"
    heritage: "Tiller"
type: Opaque
data:
  mongodb-root-password: "QzY4eFBLelhKZw=="
  mongodb-replica-set-key: "U3RsVWtVblFwMw=="
---
# Source: preview/charts/expose/templates/configmap.yaml
apiVersion: v1
data:
  config.yml: |-
    exposer: Ingress
    domain: 35.196.59.141.nip.io
    http: true
    tls-acme: false
kind: ConfigMap
metadata:
  name: exposecontroller
---
# Source: preview/charts/preview-db/templates/pvc-standalone.yaml
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  labels:
    app: preview-db
    chart: preview-db-5.3.0
    heritage: Tiller
    release: jx-vfarcic-go-demo-6-pr-34
  name: jx-vfarcic-go-demo-6-pr-34-preview-db
spec:
  accessModes:
    - "ReadWriteOnce"
  resources:
    requests:
      storage: "8Gi"
---
# Source: preview/charts/cleanup/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app: cleanup
    chart: "cleanup-2.3.56"
    release: "jx-vfarcic-go-demo-6-pr-34"
    heritage: "Tiller"
  name: cleanup
---
# Source: preview/charts/expose/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app: expose
    chart: "expose-2.3.56"
    release: "jx-vfarcic-go-demo-6-pr-34"
    heritage: "Tiller"
  name: expose
---
# Source: preview/charts/cleanup/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: cleanup
rules:
- apiGroups:
  - extensions
  resources:
  - ingresses
  verbs:
  - get
  - list
  - watch
  - patch
  - create
  - update
  - delete
- apiGroups:
  - ""
  resources:
  - configmaps
  - services
  verbs:
  - get
  - list
  - watch
  - patch
  - update
- apiGroups:
  - apps
  resources:
  - deployments
  verbs:
  - get
  - list
  - watch
  - patch
  - update
---
# Source: preview/charts/expose/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: expose
rules:
- apiGroups:
  - extensions
  resources:
  - ingresses
  verbs:
  - get
  - list
  - watch
  - patch
  - create
  - update
  - delete
- apiGroups:
  - ""
  resources:
  - configmaps
  - services
  verbs:
  - get
  - list
  - watch
  - patch
  - update
- apiGroups:
  - apps
  resources:
  - deployments
  verbs:
  - get
  - list
  - watch
  - patch
  - update
---
# Source: preview/charts/cleanup/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: cleanup
  namespace: jx-vfarcic-go-demo-6-pr-34
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: cleanup
subjects:
- kind: ServiceAccount
  name: cleanup
  namespace: jx-vfarcic-go-demo-6-pr-34
---
# Source: preview/charts/expose/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: expose
  namespace: jx-vfarcic-go-demo-6-pr-34
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: expose
subjects:
- kind: ServiceAccount
  name: expose
  namespace: jx-vfarcic-go-demo-6-pr-34
---
# Source: preview/charts/preview-db/templates/svc-standalone.yaml
apiVersion: v1
kind: Service
metadata:
  name: jx-vfarcic-go-demo-6-pr-34-preview-db
  labels:
    app: preview-db
    chart: preview-db-5.3.0
    release: "jx-vfarcic-go-demo-6-pr-34"
    heritage: "Tiller"
spec:
  type: ClusterIP
  ports:
  - name: mongodb
    port: 27017
    targetPort: mongodb
  selector:
    app: preview-db
    release: "jx-vfarcic-go-demo-6-pr-34"
---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/headless-svc-rs.yaml
apiVersion: v1
kind: Service
metadata:
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-headless
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    release: "jx-vfarcic-go-demo-6-pr-34"
    heritage: "Tiller"
spec:
  type: ClusterIP
  clusterIP: None
  ports:
  - name: mongodb
    port: 27017
  selector:
    app: go-demo-6-db
    release: jx-vfarcic-go-demo-6-pr-34
---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/svc-primary-rs.yaml
apiVersion: v1
kind: Service
metadata:
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    release: "jx-vfarcic-go-demo-6-pr-34"
    heritage: "Tiller"
spec:
  type: ClusterIP
  ports:
  - name: mongodb
    port: 27017
    targetPort: mongodb
  selector:
    app: go-demo-6-db
    release: "jx-vfarcic-go-demo-6-pr-34"
    component: primary
---
# Source: preview/charts/preview/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: go-demo-6
  labels:
    chart: "preview-0.0.0-SNAPSHOT-PR-34-4"
  annotations:
    fabric8.io/expose: "true"
    fabric8.io/ingress.annotations: 'kubernetes.io/ingress.class: nginx'
    
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8080
    protocol: TCP
    name: http
  selector:
    app: jx-vfarcic-go-demo-6-pr-34-preview
---
# Source: preview/charts/preview-db/templates/deployment-standalone.yaml
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: jx-vfarcic-go-demo-6-pr-34-preview-db
  labels:
    app: preview-db
    chart: preview-db-5.3.0
    release: "jx-vfarcic-go-demo-6-pr-34"
    heritage: "Tiller"
spec:
  selector:
    matchLabels:
      app: preview-db
      release: "jx-vfarcic-go-demo-6-pr-34"
  template:
    metadata:
      labels:
        app: preview-db
        release: "jx-vfarcic-go-demo-6-pr-34"
        chart: preview-db-5.3.0
    spec:
      securityContext:
        fsGroup: 1001
        runAsUser: 1001
      containers:
      - name: jx-vfarcic-go-demo-6-pr-34-preview-db
        image: docker.io/bitnami/mongodb:4.0.3
        imagePullPolicy: "Always"
        env:
        - name: MONGODB_ROOT_PASSWORD
          valueFrom:
            secretKeyRef:
              name: jx-vfarcic-go-demo-6-pr-34-preview-db
              key: mongodb-root-password
        - name: MONGODB_SYSTEM_LOG_VERBOSITY
          value: "0"
        - name: MONGODB_DISABLE_SYSTEM_LOG
          value: "no"
        - name: MONGODB_ENABLE_IPV6
          value: "yes"
        ports:
        - name: mongodb
          containerPort: 27017
        livenessProbe:
          exec:
            command:
            - mongo
            - --eval
            - "db.adminCommand('ping')"
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
          successThreshold: 1
          failureThreshold: 6
        readinessProbe:
          exec:
            command:
            - mongo
            - --eval
            - "db.adminCommand('ping')"
          initialDelaySeconds: 5
          periodSeconds: 10
          timeoutSeconds: 5
          successThreshold: 1
          failureThreshold: 6
        volumeMounts:
        - name: data
          mountPath: /bitnami/mongodb
        resources:
          {}
          
      volumes:
      - name: data
        persistentVolumeClaim:
          claimName: jx-vfarcic-go-demo-6-pr-34-preview-db
---
# Source: preview/charts/preview/templates/deployment.yaml
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: jx-vfarcic-go-demo-6-pr-34-preview
  labels:
    draft: draft-app
    chart: "preview-0.0.0-SNAPSHOT-PR-34-4"
spec:
  replicas: 1
  template:
    metadata:
      labels:
        draft: draft-app
        app: jx-vfarcic-go-demo-6-pr-34-preview
    spec:
      containers:
      - name: preview
        image: "10.31.240.182:5000/vfarcic/go-demo-6:0.0.0-SNAPSHOT-PR-34-4"
        imagePullPolicy: IfNotPresent
        env:
        - name: DB
          value: jx-vfarcic-go-demo-6-pr-34-preview-db
        ports:
        - containerPort: 8080
        livenessProbe:
          httpGet:
            path: /demo/hello?health=true
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        readinessProbe:
          httpGet:
            path: /demo/hello?health=true
            port: 8080
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        resources:
            limits:
              cpu: 100m
              memory: 256Mi
            requests:
              cpu: 80m
              memory: 128Mi
            
      terminationGracePeriodSeconds: 10
---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/statefulset-arbiter-rs.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    heritage: Tiller
    release: jx-vfarcic-go-demo-6-pr-34
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-arbiter
spec:
  selector:
    matchLabels:
      app: go-demo-6-db
      release: jx-vfarcic-go-demo-6-pr-34
      component: arbiter
  serviceName: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-headless
  replicas: 1
  template:
    metadata:
      labels:
        app: go-demo-6-db
        chart: go-demo-6-db-5.3.0
        release: jx-vfarcic-go-demo-6-pr-34
        component: arbiter
    spec:
      securityContext:
        fsGroup: 1001
        runAsUser: 1001
      containers:
        - name: go-demo-6-db-arbiter
          image: docker.io/bitnami/mongodb:4.0.3
          imagePullPolicy: Always
          ports:
          - containerPort: 27017
            name: mongodb
          env:
          - name: MONGODB_SYSTEM_LOG_VERBOSITY
            value: "0"
          - name: MONGODB_DISABLE_SYSTEM_LOG
            value: "no"
          - name: MONGODB_POD_NAME
            valueFrom:
              fieldRef:
                fieldPath: metadata.name
          - name: MONGODB_REPLICA_SET_MODE
            value: "arbiter"
          - name: MONGODB_PRIMARY_HOST
            value: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
          - name: MONGODB_REPLICA_SET_NAME
            value: "rs0"
          - name: MONGODB_ADVERTISED_HOSTNAME
            value: "$(MONGODB_POD_NAME).jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-headless.jx-vfarcic-go-demo-6-pr-34.svc.cluster.local"
          - name: MONGODB_PRIMARY_ROOT_PASSWORD
            valueFrom:
              secretKeyRef:
                name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
                key: mongodb-root-password
          - name: MONGODB_REPLICA_SET_KEY
            valueFrom:
              secretKeyRef:
                name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
                key: mongodb-replica-set-key
          - name: MONGODB_ENABLE_IPV6
            value: "yes"
          livenessProbe:
            tcpSocket:
              port: mongodb
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            tcpSocket:
              port: mongodb
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
          resources:
            {}
            
      volumes:
---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/statefulset-primary-rs.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    heritage: Tiller
    release: jx-vfarcic-go-demo-6-pr-34
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-primary
spec:
  serviceName: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-headless
  replicas: 1
  selector:
    matchLabels:
      app: go-demo-6-db
      release: jx-vfarcic-go-demo-6-pr-34
      component: primary
  template:
    metadata:
      labels:
        app: go-demo-6-db
        chart: go-demo-6-db-5.3.0
        release: jx-vfarcic-go-demo-6-pr-34
        component: primary
    spec:
      securityContext:
        fsGroup: 1001
        runAsUser: 1001
      containers:
        - name: go-demo-6-db-primary
          image: docker.io/bitnami/mongodb:4.0.3
          imagePullPolicy: Always
          ports:
          - containerPort: 27017
            name: mongodb
          env:
          - name: MONGODB_SYSTEM_LOG_VERBOSITY
            value: "0"
          - name: MONGODB_DISABLE_SYSTEM_LOG
            value: "no"
          - name: MONGODB_POD_NAME
            valueFrom:
              fieldRef:
                fieldPath: metadata.name
          - name: MONGODB_REPLICA_SET_MODE
            value: "primary"
          - name: MONGODB_REPLICA_SET_NAME
            value: "rs0"
          - name: MONGODB_ADVERTISED_HOSTNAME
            value: "$(MONGODB_POD_NAME).jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-headless.jx-vfarcic-go-demo-6-pr-34.svc.cluster.local"
          - name: MONGODB_ROOT_PASSWORD
            valueFrom:
              secretKeyRef:
                name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
                key: mongodb-root-password
          - name: MONGODB_REPLICA_SET_KEY
            valueFrom:
              secretKeyRef:
                name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
                key: mongodb-replica-set-key
          - name: MONGODB_ENABLE_IPV6
            value: "yes"
          livenessProbe:
            exec:
              command:
                - mongo
                - --eval
                - "db.adminCommand('ping')"
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            exec:
              command:
                - mongo
                - --eval
                - "db.adminCommand('ping')"
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
            - name: datadir
              mountPath: /bitnami/mongodb
          resources:
            {}
            
      volumes:
  volumeClaimTemplates:
    - metadata:
        name: datadir
        annotations:
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "8Gi"
---
# Source: preview/charts/preview/charts/go-demo-6-db/templates/statefulset-secondary-rs.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  labels:
    app: go-demo-6-db
    chart: go-demo-6-db-5.3.0
    heritage: Tiller
    release: jx-vfarcic-go-demo-6-pr-34
  name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-secondary
spec:
  selector:
    matchLabels:
      app: go-demo-6-db
      release: jx-vfarcic-go-demo-6-pr-34
      component: secondary
  podManagementPolicy: "Parallel"
  serviceName: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-headless
  replicas: 1
  template:
    metadata:
      labels:
        app: go-demo-6-db
        chart: go-demo-6-db-5.3.0
        release: jx-vfarcic-go-demo-6-pr-34
        component: secondary
    spec:
      securityContext:
        fsGroup: 1001
        runAsUser: 1001
      containers:
        - name: go-demo-6-db-secondary
          image: docker.io/bitnami/mongodb:4.0.3
          imagePullPolicy: Always
          ports:
          - containerPort: 27017
            name: mongodb
          env:
          - name: MONGODB_SYSTEM_LOG_VERBOSITY
            value: "0"
          - name: MONGODB_DISABLE_SYSTEM_LOG
            value: "no"
          - name: MONGODB_POD_NAME
            valueFrom:
              fieldRef:
                fieldPath: metadata.name
          - name: MONGODB_REPLICA_SET_MODE
            value: "secondary"
          - name: MONGODB_PRIMARY_HOST
            value: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
          - name: MONGODB_REPLICA_SET_NAME
            value: "rs0"
          - name: MONGODB_ADVERTISED_HOSTNAME
            value: "$(MONGODB_POD_NAME).jx-vfarcic-go-demo-6-pr-34-go-demo-6-db-headless.jx-vfarcic-go-demo-6-pr-34.svc.cluster.local"
          - name: MONGODB_PRIMARY_ROOT_PASSWORD
            valueFrom:
              secretKeyRef:
                name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
                key: mongodb-root-password
          - name: MONGODB_REPLICA_SET_KEY
            valueFrom:
              secretKeyRef:
                name: jx-vfarcic-go-demo-6-pr-34-go-demo-6-db
                key: mongodb-replica-set-key
          - name: MONGODB_ENABLE_IPV6
            value: "yes"
          livenessProbe:
            exec:
              command:
                - mongo
                - --eval
                - "db.adminCommand('ping')"
            initialDelaySeconds: 30
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          readinessProbe:
            exec:
              command:
                - mongo
                - --eval
                - "db.adminCommand('ping')"
            initialDelaySeconds: 5
            periodSeconds: 10
            timeoutSeconds: 5
            successThreshold: 1
            failureThreshold: 6
          volumeMounts:
            - name: datadir
              mountPath: /bitnami/mongodb
          resources:
            {}
            
      volumes:
  volumeClaimTemplates:
    - metadata:
        name: datadir
        annotations:
      spec:
        accessModes:
          - "ReadWriteOnce"
        resources:
          requests:
            storage: "8Gi"
